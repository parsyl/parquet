package bitpack

// Code generated by github.com/inigolabs/parquet.  DO NOT EDIT.

const MaxSize = 4

func Pack(b []byte, width int, vals []uint8) []byte {
	switch width {
	case 1:
		return pack1(b, vals)
	case 2:
		return pack2(b, vals)
	case 3:
		return pack3(b, vals)
	case 4:
		return pack4(b, vals)
	default:
		return b
	}
}

func pack1(b []byte, vals []uint8) []byte {
	return append(b,
		(byte((vals[0]&1)<<0) |
			byte((vals[1]&1)<<1) |
			byte((vals[2]&1)<<2) |
			byte((vals[3]&1)<<3) |
			byte((vals[4]&1)<<4) |
			byte((vals[5]&1)<<5) |
			byte((vals[6]&1)<<6) |
			byte((vals[7]&1)<<7)),
	)
}

func pack2(b []byte, vals []uint8) []byte {
	return append(b,
		(byte((vals[0]&3)<<0) |
			byte((vals[1]&3)<<2) |
			byte((vals[2]&3)<<4) |
			byte((vals[3]&3)<<6)),
		(byte((vals[4]&3)<<0) |
			byte((vals[5]&3)<<2) |
			byte((vals[6]&3)<<4) |
			byte((vals[7]&3)<<6)),
	)
}

func pack3(b []byte, vals []uint8) []byte {
	return append(b,
		(byte((vals[0]&7)<<0) |
			byte((vals[1]&7)<<3) |
			byte((vals[2]&3)<<6)),
		(byte((vals[2]&4)>>2) |
			byte((vals[3]&7)<<1) |
			byte((vals[4]&7)<<4) |
			byte((vals[5]&1)<<7)),
		(byte((vals[5]&6)>>1) |
			byte((vals[6]&7)<<2) |
			byte((vals[7]&7)<<5)),
	)
}

func pack4(b []byte, vals []uint8) []byte {
	return append(b,
		(byte((vals[0]&15)<<0) |
			byte((vals[1]&15)<<4)),
		(byte((vals[2]&15)<<0) |
			byte((vals[3]&15)<<4)),
		(byte((vals[4]&15)<<0) |
			byte((vals[5]&15)<<4)),
		(byte((vals[6]&15)<<0) |
			byte((vals[7]&15)<<4)),
	)
}

func Unpack(width int, vals []byte) []uint8 {
	switch width {
	case 1:
		return unpack1(vals)
	case 2:
		return unpack2(vals)
	case 3:
		return unpack3(vals)
	case 4:
		return unpack4(vals)
	default:
		return []uint8{}
	}
}

func unpack1(vals []byte) []uint8 {
	return []uint8{
		(uint8(vals[0]&1) >> 0),
		(uint8(vals[0]&2) >> 1),
		(uint8(vals[0]&4) >> 2),
		(uint8(vals[0]&8) >> 3),
		(uint8(vals[0]&16) >> 4),
		(uint8(vals[0]&32) >> 5),
		(uint8(vals[0]&64) >> 6),
		(uint8(vals[0]&128) >> 7),
	}
}

func unpack2(vals []byte) []uint8 {
	return []uint8{
		(uint8(vals[0]&3) >> 0),
		(uint8(vals[0]&12) >> 2),
		(uint8(vals[0]&48) >> 4),
		(uint8(vals[0]&192) >> 6),
		(uint8(vals[1]&3) >> 0),
		(uint8(vals[1]&12) >> 2),
		(uint8(vals[1]&48) >> 4),
		(uint8(vals[1]&192) >> 6),
	}
}

func unpack3(vals []byte) []uint8 {
	return []uint8{
		(uint8(vals[0]&7) >> 0),
		(uint8(vals[0]&56) >> 3),
		(uint8(vals[0]&192) >> 6) | (uint8(vals[1]&1) << 2),
		(uint8(vals[1]&14) >> 1),
		(uint8(vals[1]&112) >> 4),
		(uint8(vals[1]&128) >> 7) | (uint8(vals[2]&3) << 1),
		(uint8(vals[2]&28) >> 2),
		(uint8(vals[2]&224) >> 5),
	}
}

func unpack4(vals []byte) []uint8 {
	return []uint8{
		(uint8(vals[0]&15) >> 0),
		(uint8(vals[0]&240) >> 4),
		(uint8(vals[1]&15) >> 0),
		(uint8(vals[1]&240) >> 4),
		(uint8(vals[2]&15) >> 0),
		(uint8(vals[2]&240) >> 4),
		(uint8(vals[3]&15) >> 0),
		(uint8(vals[3]&240) >> 4),
	}
}
